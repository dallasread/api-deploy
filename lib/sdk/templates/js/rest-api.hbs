var API = {
    debug: false,

{{#each methods}}
    {{#if data.x-api-deploy}}
        {{#if data.x-api-deploy.sdk.method}}
    {{data.x-api-deploy.sdk.method}}: function {{data.x-api-deploy.sdk.method}}(data, headers, done) {
    {{#if data.x-amazon-lambda.arn}}
        if (!done && typeof headers === 'function') {
            done = headers;
            headers = null;
        }

        if (!done && this.debug) {
            console.warn('No callback supplied.');
        }

        $.ajax({
            method: '{{_method}}',
            url: '{{../sdk.url}}{{_path}}',
            data: '{{_method}}' === 'GET' ? data : JSON.stringify(data),
            beforeSend: function (xhr) {
                for (var key in headers) {
                    xhr.setRequestHeader(key, headers[key]);
                }
            },
            complete: function(data) {
                if (data.responseJSON) {
                    if (data.responseJSON.errorMessage) {
                        typeof done === 'function' && done(data.responseJSON, null);
                    } else {
                        typeof done === 'function' && done(null, data.responseJSON);
                    }
                } else {
                    typeof done === 'function' && done(new Error('Could not complete network request.'));
                }
            }
        });
    {{else}}
        this.debug && console.warn('Api Gateway Endpoint not deployed:', '{{data.x-api-deploy.sdk.method}}');
    {{/if}}
    },
        {{/if}}
    {{/if}}
{{/each}}
};

if (window) window.{{sdk.name}} = API;
module.exports = API;
